name: Ngrok Test

on:
  workflow_dispatch

jobs:
  ngrok-test:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Install Ngrok
      run: |
        wget -q -O ngrok.tgz https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-amd64.tgz
        tar -xzf ngrok.tgz
        ./ngrok version

    - name: Setup auth
      run: |
        ./ngrok authtoken "${{ secrets.NGROK_AUTH_TOKEN }}"
        echo "Auth configured"

    - name: Start tunnel
      run: |
        ./ngrok http 8080 &
        echo "Tunnel starting..."
        sleep 10
        echo "Check ngrok dashboard for URL"
        sleep 300
